<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Models • grplasso</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Models">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grplasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/grplasso.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix">
<li><a class="dropdown-item" href="../articles/Models.html">Models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/grplasso/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/grplasso/blob/HEAD/vignettes/Models.Rmd" class="external-link"><code>vignettes/Models.Rmd</code></a></small>
      <div class="d-none name"><code>Models.Rmd</code></div>
    </div>

    
    
<p>Suppose we have total
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
subjects from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
transplant centers with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>
records from center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">i = 1, ..., m</annotation></semantics></math>).
Coefficients of risk factors are denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>P</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><annotation encoding="application/x-tex">(\beta_1, \dots, \beta_P)^T</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛄</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>γ</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\gamma} = (\gamma_1, ..., \gamma_m)^T</annotation></semantics></math>
denote the effect of centers.</p>
<div class="section level2">
<h2 id="generalized-linear-models">Generalized Linear Models<a class="anchor" aria-label="anchor" href="#generalized-linear-models"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
denotes the outcome variable for record
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">(</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j \ (j = 1, ..., n_i</annotation></semantics></math>)
of center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{X}_{ij}</annotation></semantics></math>
be the corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">1 \times P</annotation></semantics></math>
vector of risk factors. We assume that given the linear predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>:=</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow><annotation encoding="application/x-tex">\eta_{ij} := \gamma_i +  \boldsymbol{X}_{ij}\boldsymbol{\beta}</annotation></semantics></math>,
the outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
follows a distribution in the exponential family. Incorporate with
penalty terms, our problem of interest is estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝛄</mi><mi>T</mi></msup><mo>,</mo><msup><mi>𝛃</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\boldsymbol{\gamma}^T, \boldsymbol{\beta}^T)^T</annotation></semantics></math>
by minimizing:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><msub><mi>λ</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>β</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Q_{\lambda}(\boldsymbol{\theta}) = -\frac{1}{n}\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \{Y_{ij}(\gamma_i +  \boldsymbol{X}_{ij}\boldsymbol{\beta}) - b(\gamma_i +  \boldsymbol{X}_{ij}\boldsymbol{\beta})\} + \sum_{p = 1}^P \lambda_{p} |\beta_p|,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\lambda_{p}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p = 1,2,...,P)</annotation></semantics></math>
is the regularization parameter for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\beta_p</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="two-layer-iterative-update-procedure">Two-layer iterative update procedure<a class="anchor" aria-label="anchor" href="#two-layer-iterative-update-procedure"></a>
</h3>
<div class="section level4">
<h4 id="outer-layer-update-the-provider-effect-boldsymbolgamma">outer layer: update the provider effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#outer-layer-update-the-provider-effect-boldsymbolgamma"></a>
</h4>
<p>Given the previous iteration’s estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
(denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\boldsymbol{\beta}}</annotation></semantics></math>),
consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛄</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><msub><mi>Q</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝛄</mi><mi>T</mi></msup><mo>,</mo><msup><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\gamma}}(\boldsymbol{\gamma}) \propto Q_{\lambda}((\boldsymbol{\gamma}^T, \tilde{\boldsymbol{\beta}}^T)^T)</annotation></semantics></math>
that is defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛄</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex"> Q_{\lambda, \boldsymbol{\gamma}}(\boldsymbol{\gamma}) = - \frac{1}{n} \sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \{Y_{ij}(\gamma_i + \boldsymbol{X}_{ij} \tilde{\boldsymbol{\beta}}) - b(\gamma_i + \boldsymbol{X}_{ij} \tilde{\boldsymbol{\beta}})\}.</annotation></semantics></math></p>
<p>Since the score function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛄</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\gamma}}(\boldsymbol{\gamma})</annotation></semantics></math>
is separable for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
and the fisher information matrix is diagonal,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math>
can be updated separately using only a subset of the entire data by a
one-step Newton procedure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><mover><msub><mi>γ</mi><mi>i</mi></msub><mo accent="true">̃</mo></mover><mo>+</mo><msubsup><mi>I</mi><mi>λ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>U</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{\gamma}_i = \tilde{\gamma_i} + I_{\lambda}^{-1}(\tilde{\gamma}_i) U_{\lambda}(\tilde{\gamma}_i).</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="inner-layer-update-the-covariate-coefficient-boldsymbolbeta">inner layer: update the covariate coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#inner-layer-update-the-covariate-coefficient-boldsymbolbeta"></a>
</h4>
<p>Based on the updated value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
(i.e. the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\gamma}}</annotation></semantics></math>
that was updated previously), consider
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛃</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Q</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><mi>T</mi></msup><mo>,</mo><msup><mi>𝛃</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msub><mi>ℒ</mi><mi>β</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><msub><mi>λ</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>β</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\beta}}(\boldsymbol{\beta}) = Q_{\lambda}((\hat{\boldsymbol{\gamma}}^T, \boldsymbol{\beta}^T)^T) = \frac{1}{n}\mathcal{L}_{\beta}(\boldsymbol{\beta}) + \sum_{p = 1}^P \lambda_{p} |\beta_p|,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><mi>β</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\beta}(\boldsymbol{\beta}) = - \sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \{Y_{ij}(\hat{\gamma}_i + \boldsymbol{X}_{ij} \boldsymbol{\beta}) - b(\hat{\gamma}_i + \boldsymbol{X}_{ij} \boldsymbol{\beta})\}</annotation></semantics></math>.</p>
<p>The coordinate-wise updating function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
utilizing the sub-differential calculus is given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>S</mi><mo stretchy="false" form="prefix">{</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mover><mi>w</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>n</mi><msub><mi>λ</mi><mi>p</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mover><mi>w</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mn>2</mn></msup></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{\beta}_p = \frac{S\{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \tilde{w}_{ij} {X_{ijp}} (Z(\tilde{\eta}_{ij}) - \hat{\gamma}_i - \boldsymbol{X}_{ij} \hat{\boldsymbol{\beta}}_{(-p)}), n\lambda_p\}}{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \tilde{w}_{ij} {X_{ijp}}^2},</annotation></semantics></math>
where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>Z</mi><mo>−</mo><mi>λ</mi><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">if</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>Z</mi><mo>&gt;</mo><mi>λ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mn>0</mn><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">if</mtext><mspace width="0.222em"></mspace><mo>−</mo><mi>λ</mi><mo>≤</mo><mi>Z</mi><mo>≤</mo><mi>λ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>Z</mi><mo>+</mo><mi>λ</mi><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">if</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>Z</mi><mo>&lt;</mo><mi>−</mi><mi>λ</mi></mtd></mtr></mtable></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">S(Z, \lambda) = \begin{cases} Z - \lambda,\ \ \text{if} \ \ \ Z &gt; \lambda \\ \ \ \ 0, \ \ \ \ \ \text{if} \  -\lambda \leq Z \leq \lambda \\ Z + \lambda, \ \ \text{if} \ \ \ Z &lt; -\lambda \end{cases},</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo>−</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ℒ</mi><mi>η</mi></msub><mi>″</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>ℒ</mi><mi>η</mi></msub><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">Z(\tilde{\eta}_{ij}) = \hat{\gamma}_i + \boldsymbol{X}_{ij} \tilde{\boldsymbol{\beta}} -  \{\mathcal{L}_{\eta}''(\tilde{\boldsymbol{\eta}})
^{-1} \mathcal{L}_{\eta}'(\tilde{\boldsymbol{\eta}})\}_{ij},</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>ω</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>ℒ</mi><mi>η</mi></msub><mi>″</mi><msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\tilde{\omega}_{ij} = \mathcal{L}_{\eta}''(\tilde{\boldsymbol{\eta}})_{ij}.</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="extensions-covariates-with-group-information">Extensions: Covariates with Group Information<a class="anchor" aria-label="anchor" href="#extensions-covariates-with-group-information"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{X}_{ij}</annotation></semantics></math>
be a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>p</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">1 \times \sum_{k = 1}^K p_k</annotation></semantics></math>
vector of risk factors that are divided into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
non-overlapping groups
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>k</mi></msub><annotation encoding="application/x-tex">p_k</annotation></semantics></math>
denotes the length of group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>).
The coefficients of risk factors are denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msubsup><mi>𝛃</mi><mn>1</mn><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">(\boldsymbol{\beta}_1^T</annotation></semantics></math>,
…,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝛃</mi><mi>K</mi><mi>T</mi></msubsup><msup><mo stretchy="false" form="postfix">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_K^T)^T</annotation></semantics></math>.
Given the observed data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{(Y_{ij}, \boldsymbol{X}_{ij})\}</annotation></semantics></math>,
our problem of interest becomes estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝛄</mi><mi>T</mi></msup><mo>,</mo><msup><mi>𝛃</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\boldsymbol{\gamma}^T, \boldsymbol{\beta}^T)^T</annotation></semantics></math>
by minimizing
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>λ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>𝛃</mi><mi>k</mi></msub><msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msub><mo>,</mo></mrow><annotation encoding="application/x-tex"> Q_{\lambda}(\boldsymbol{\theta}) = \frac{1}{n} \mathcal{L}(\boldsymbol{\theta}) + \sum_{k = 1}^K \lambda_k ||\boldsymbol{\beta}_k||_2,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>𝛃</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>𝐗</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>𝛃</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\boldsymbol{\theta}) = - \sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \{Y_{ij}(\gamma_i + \sum_{k = 1}^K \boldsymbol{X}_{ijk}\boldsymbol{\beta}_k) - b(\gamma_i + \sum_{k = 1}^K \boldsymbol{X}_{ijk}\boldsymbol{\beta}_k)\}</annotation></semantics></math>
is the loss function, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>𝛃</mi><mi>k</mi></msub><msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">||\boldsymbol{\beta}_k||_2</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>
norm of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛃</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_k</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math>
is the regularization parameter on group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
with default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub><mo>=</mo><mi>λ</mi><msqrt><msub><mi>p</mi><mi>k</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\lambda_k = \lambda \sqrt{p_k}</annotation></semantics></math>.</p>
<p>In the outer layer of each iteration, the center effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>’s
are updated the same way as we discussed previously.</p>
<p>In the inner layer, we use the Majorize-Minimization (MM) algorithm
to improve the efficiency of our algorithm for binary outcomes. Based on
the current value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\gamma}}</annotation></semantics></math>,
the subdifferential-based group-wise updating function of the objective
function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mi>k</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mo>−</mo><mfrac><msub><mi>λ</mi><mi>k</mi></msub><mi>v</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow></mrow></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>v</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><msub><mi>λ</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>v</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mo>≤</mo><msub><mi>λ</mi><mi>k</mi></msub></mtd></mtr></mtable></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_k = \begin{cases} (||\tilde{\boldsymbol{z}}_k|| - \frac{\lambda_k}{v}) \frac{\tilde{\boldsymbol{z}}_k}{||\tilde{\boldsymbol{z}}_k||},   &amp; \text{if} \ \ v\cdot||\tilde{\boldsymbol{z}}_k|| &gt; \lambda_k \\
    0,  &amp; \text{if} \ \ v\cdot||\tilde{\boldsymbol{z}}_k|| \leq \lambda_k  \end{cases},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>𝐳</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msup><msub><mi>𝐗</mi><mi>k</mi></msub><mi>T</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><mo>−</mo><mi>𝐗</mi><msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{z}}_k = \frac{1}{n} {\boldsymbol{X}_k}^T (Z(\tilde{\boldsymbol{\eta}}) - \hat{\boldsymbol{\gamma}} - \boldsymbol{X} \tilde{\boldsymbol{\beta}}_{(-k)})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">v = 0.25</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">\tilde{\boldsymbol{\beta}}_{(-k)}</annotation></semantics></math>
is the most recently updated value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
but set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><annotation encoding="application/x-tex">\tilde{\boldsymbol{\beta}}_k</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>𝟎</mn><annotation encoding="application/x-tex">\boldsymbol{0}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝐘</mi></mrow><annotation encoding="application/x-tex">Z(\tilde{\boldsymbol{\eta}}) = \boldsymbol{Y}</annotation></semantics></math>
for continuous outcome and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><mo>+</mo><mi>𝐗</mi><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo>+</mo><mfrac><mn>1</mn><mi>v</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐘</mi><mo>−</mo><mover><mi>𝐩</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z(\tilde{\boldsymbol{\eta}}) = \hat{\boldsymbol{\gamma}} + \boldsymbol{X} \tilde{\boldsymbol{\beta}} + \frac{1}{v}(\boldsymbol{Y} - \tilde{\boldsymbol{p}})</annotation></semantics></math>
for binary outcome.</p>
</div>
</div>
<div class="section level2">
<h2 id="discrete-survival-logistic-model">Discrete Survival Logistic Model<a class="anchor" aria-label="anchor" href="#discrete-survival-logistic-model"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{T}_{ij}</annotation></semantics></math>
represent the underlying uncensored failure time and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">C_{ij}</annotation></semantics></math>
be the censoring time of individual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
of center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{Z}_{ij}</annotation></semantics></math>
denote the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1 \times p</annotation></semantics></math>
vector of risk factors of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>j</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">j^{th}</annotation></semantics></math>
individual from center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\Delta_i</annotation></semantics></math>
is the center indicator, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">T_{ij}</annotation></semantics></math>
be the corresponding observed failure or censor time with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋃</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>t</mi><mi>K</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\bigcup\{T_{ij}\} = \{t_{1}, t_{2}, ..., t_{K}\}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>t</mi><mn>2</mn></msub><mo>&lt;</mo><mi>⋯</mi><mo>&lt;</mo><msub><mi>t</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">t_{1} &lt; t_{2} &lt; \cdots &lt; t_{K}</annotation></semantics></math>
is the discrete failure times indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">m = 1, 2, ..., K</annotation></semantics></math>.
We assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>T</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{T}_{ij}</annotation></semantics></math>
is independent with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">C_{ij}</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{Z}_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\Delta_i</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mover><mi>T</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≥</mo><msub><mi>t</mi><mi>k</mi></msub><mo>,</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda(t_k; \boldsymbol{Z}_{ij}, \Delta_i) = P(\tilde{T}_{ij} = t_i | \tilde{T}_{ij} \geq t_k, \boldsymbol{Z}_{ij}, \Delta_i)</annotation></semantics></math>
be the hazard for the individual with risk factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{Z}_{ij}</annotation></semantics></math>
and from center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝒟</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{D}_{i,k}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝒞</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{C}_{i,k}</annotation></semantics></math>
be the set of indices attached to individuals from center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
failing and censoring at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>,
respectively.</p>
<p>The full likelihood function is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><munderover><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo stretchy="true" form="prefix">{</mo><munder><mo>∏</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>𝒟</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow></munder><mrow><mo stretchy="true" form="prefix">[</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>t</mi><mi>k</mi><mo>−</mo></msubsup><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><munder><mo>∏</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>𝒞</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow></munder><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex"> L=\prod_{k=1}^{K} \prod_{i=1}^{m} \left\{\prod_{j \in \mathcal{D}_{i,k}} [F(t_k^-; \boldsymbol{Z}_{ij}, \Delta_i) - F(t_k; \boldsymbol{Z}_{ij}, \Delta_i)] \prod_{j \in \mathcal{C}_{i,k}} F(t_k; \boldsymbol{Z}_{ij}, \Delta_i)\right\},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>T</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∏</mo><mrow><mi>l</mi><mo>∣</mo><msub><mi>t</mi><mi>l</mi></msub><mo>≤</mo><msub><mi>t</mi><mi>k</mi></msub></mrow></munder><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>l</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">F(t_k; \boldsymbol{Z}_{ij}, \Delta_i) = P(\tilde{T}_{ij} &gt; t_k|\boldsymbol{Z}_{ij}, \Delta_i) = \prod\limits_{l \mid t_{l} \leq t_k}\{1 - \lambda(t_l; \boldsymbol{Z}_{ij}, \Delta_i)\}</annotation></semantics></math>
is the survival function at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>
corresponding to individual from center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
with covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{Z}_{ij}</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda_0(t_k)</annotation></semantics></math>
be the discrete baseline hazard function at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>,
then the hazard relationship for the discrete-time logistic model is
defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>;</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>Δ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>λ</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>λ</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">log(\frac{\lambda(t_k; \boldsymbol{Z}_{ij}, \Delta_i)}{1 - \lambda(t_k; \boldsymbol{Z}_{ij}, \Delta_i)}) = log(\frac{\lambda_0(t_k)}{1 - \lambda_0(t_k)}) + \gamma_i + \boldsymbol{Z}_{ij} \boldsymbol{\beta}.</annotation></semantics></math>
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>λ</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>λ</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_k = log(\frac{\lambda_0(t_k)}{1 - \lambda_0(t_k)})</annotation></semantics></math>,
then our problem of interest is estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><msup><mi>𝛂</mi><mi>𝐓</mi></msup><mo mathvariant="bold">,</mo><mi>𝛄</mi></mrow><mi>T</mi></msup><mo>,</mo><msup><mi>𝛃</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\boldsymbol{\boldsymbol{\alpha}^T, \gamma}^T, \boldsymbol{\beta}^T)^T</annotation></semantics></math>
by minimizing:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><msub><mi>λ</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>β</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">Q_{\lambda}(\boldsymbol{\theta}) = -\frac{1}{n} \sum_{i = 1}^m \sum_{j=1}^{n_i} \sum_{k=1}^{k_{ij}} \{\delta_{ij}\left(t_{k}\right) \cdot (\alpha_k + \gamma_i + \boldsymbol{Z}_{ij} \boldsymbol{\beta}) -log(1 + e^{\alpha_k + \gamma_i + \boldsymbol{Z}_{ij} \boldsymbol{\beta}}) \} + \sum_{p = 1}^P \lambda_{p} |\beta_p|</annotation></semantics></math></p>
<div class="section level3">
<h3 id="three-layer-iterative-update-procedure">Three-layer iterative update procedure<a class="anchor" aria-label="anchor" href="#three-layer-iterative-update-procedure"></a>
</h3>
<div class="section level4">
<h4 id="outer-layer-update-the-log-transformed-baseline-hazard-boldsymbolalpha">outer layer: update the log-transformed baseline hazard
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛂</mi><annotation encoding="application/x-tex">\boldsymbol{\alpha}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#outer-layer-update-the-log-transformed-baseline-hazard-boldsymbolalpha"></a>
</h4>
<p>Given the previous iteration’s estimate of center effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛄</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\boldsymbol{\gamma}}</annotation></semantics></math>
and coefficient of risk factors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\boldsymbol{\beta}}</annotation></semantics></math>,
we consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛂</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛂</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\alpha}}(\boldsymbol{\alpha}) = - \frac{1}{n} \sum\limits_{i = 1}^m \sum\limits_{j=1}^{n_i} \sum\limits_{k=1}^{k_{ij}} \{\delta_{ij}\left(t_{k}\right) \cdot (\alpha_k + \tilde{\gamma}_{i} +  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}) -log(1 + e^{\alpha_k + \tilde{\gamma}_{i} +  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}) \}</annotation></semantics></math>.
The Newton method allows us to update
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
separately by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>=</mo><msub><mover><mi>α</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mo>+</mo><msubsup><mi>I</mi><mi>λ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>α</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>U</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>α</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{\alpha}_k = \tilde{\alpha}_k + I_{\lambda}^{-1}(\tilde{\alpha}_k) U_{\lambda}(\tilde{\alpha}_k),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>α</mi><mo accent="true">̃</mo></mover><mi>k</mi></msub><annotation encoding="application/x-tex">\tilde{\alpha}_k</annotation></semantics></math>
is the current value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math>,
and <span class="math display">$$U_{\lambda}(\tilde{\alpha}_k) = -
\frac{1}{n} \sum_{i = 1}^m \{\sum_{j = 1}^{n_i} \delta_{ij}
\left(t_{k}\right) - \sum_{j|T_{ij} \geq t_k} \frac{e^{\tilde{\alpha}_k
+ \tilde{\gamma}_i +  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}}{1
+ e^{\tilde{\alpha}_k + \tilde{\gamma}_i +  \boldsymbol{Z}_{ij}
\tilde{\boldsymbol{\beta}}}}\} \\
     I_{\lambda}(\tilde{\alpha}_k) = - \frac{1}{n} \sum_{i = 1}^m
\sum_{j|T_{ij} \geq t_k} \frac{e^{\tilde{\alpha}_k + \tilde{\gamma}_i
+  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}}{(1 +
e^{\tilde{\alpha}_k + \tilde{\gamma}_i +  \boldsymbol{Z}_{ij}
\tilde{\boldsymbol{\beta}}})^2}.$$</span></p>
</div>
<div class="section level4">
<h4 id="middle-layer-update-the-provider-effect-boldsymbolgamma">middle layer: update the provider effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#middle-layer-update-the-provider-effect-boldsymbolgamma"></a>
</h4>
<p>Given the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛂</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\alpha}}</annotation></semantics></math>
updated above and the most recently updated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\boldsymbol{\beta}}</annotation></semantics></math>,
we consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛄</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\gamma}}(\boldsymbol{\gamma}) = - \frac{1}{n} \sum\limits_{i = 1}^m \sum\limits_{j=1}^{n_i} \sum\limits_{k=1}^{k_{ij}} \{\delta_{ij}\left(t_{k}\right) \cdot (\hat{\alpha}_k + \gamma_{i} +  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}) -log(1 + e^{\hat{\alpha}_k + \gamma_{i} +  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}) \}</annotation></semantics></math>.
Use a similar one-step Newton method we should have
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo>+</mo><msubsup><mi>I</mi><mi>λ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>U</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{\gamma}_i = \tilde{\gamma}_i + I_{\lambda}^{-1}(\tilde{\gamma}_i) U_{\lambda}(\tilde{\gamma}_i),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_{i}</annotation></semantics></math>
represent the most recently updated value of effect of center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and <span class="math display">$$U_{\lambda}(\tilde{\gamma}_i) = -
\frac{1}{n} \sum_{j = 1}^{n_i} \sum_{k = 1}^{k_{ij}} \{\delta_{ij}
\left(t_{k}\right) - \frac{e^{\hat{\alpha}_k + \tilde{\gamma}_i
+  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}}{1 +
e^{\hat{\alpha}_k + \tilde{\gamma}_i +  \boldsymbol{Z}_{ij}
\tilde{\boldsymbol{\beta}}}}\} \\
     I_{\lambda}(\tilde{\gamma}_i) = - \frac{1}{n}  \sum_{j = 1}^{n_i}
\sum_{k = 1}^{k_{ij}} \frac{e^{\hat{\alpha}_k + \tilde{\gamma}_i
+  \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}}}{(1 +
e^{\hat{\alpha}_k + \tilde{\gamma}_i +  \boldsymbol{Z}_{ij}
\tilde{\boldsymbol{\beta}}})^2}.$$</span></p>
<p>It should be noted that the effect of the first provider is set to
zero (as the reference group) to prevent issues of
multicollinearity.</p>
</div>
<div class="section level4">
<h4 id="inner-layer-update-the-covariate-coefficient-boldsymbolbeta-1">inner layer: update the covariate coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#inner-layer-update-the-covariate-coefficient-boldsymbolbeta-1"></a>
</h4>
<p>Based on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛂</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\alpha}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\gamma}}</annotation></semantics></math>
updated from the previous two steps, define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><mi>β</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\beta}(\boldsymbol{\beta}) = - \frac{1}{n} \sum\limits_{i = 1}^m \sum\limits_{j=1}^{n_i} \sum\limits_{k=1}^{k_{ij}} \{\delta_{ij}\left(t_{k}\right) \cdot (\hat{\alpha}_k + \hat{\gamma}_{i} +  \boldsymbol{Z}_{ij} \boldsymbol{\beta}) -log(1 + e^{\hat{\alpha}_k + \hat{\gamma}_{i} +  \boldsymbol{Z}_{ij} \boldsymbol{\beta}}) \}</annotation></semantics></math>
and consider
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>λ</mi><mo>,</mo><mi>𝛃</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msub><mi>ℒ</mi><mi>β</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>λ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>β</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">Q_{\lambda, \boldsymbol{\beta}}(\boldsymbol{\beta}) = \frac{1}{n}  \mathcal{L}_{\beta}(\boldsymbol{\beta}) + \sum_{k = 1}^p \lambda_{k} |\beta_k|.</annotation></semantics></math></p>
<p>Denote
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ℒ</mi><mi>η</mi></msub><mi>″</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>ℒ</mi><mi>η</mi></msub><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛈</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">Z(\tilde{\eta}_{ij}) = \tilde{\eta}_{ij} -  \{\mathcal{L}_{\eta}''(\tilde{\boldsymbol{\eta}})^{-1} \mathcal{L}_{\eta}'(\tilde{\boldsymbol{\eta}})\}_{ij} = \tilde{\eta}_{ij} + \frac{\sum\limits_{k = 1}^{k_{ij}}[\delta_{ij}(t_k) - \frac{e^{\hat{\alpha}_k + \tilde{\eta}_{ij}}}{1 + e^{\hat{\alpha}_k + \tilde{\eta}_{ij}}}]}{\sum\limits_{k = 1}^{k_{ij}} \frac{e^{\hat{\alpha}_k + \tilde{\eta}_{ij}}}{(1 + e^{\hat{\alpha}_k + \tilde{\eta}_{ij}})^2}},</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>ω</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\tilde{\omega}_{ij} = \sum\limits_{k = 1}^{k_{ij}} \frac{e^{\hat{\alpha}_k + \tilde{\eta}_{ij}}}{(1 + e^{\hat{\alpha}_k + \tilde{\eta}_{ij}})^2},</annotation></semantics></math>
then the coordinate-wise updating function will be given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>S</mi><mo stretchy="false" form="prefix">{</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mover><mi>w</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>n</mi><msub><mi>λ</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mover><mi>w</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mn>2</mn></msup></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\beta_p = \frac{S\{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \tilde{w}_{ij} {Z_{ijp}} (Z(\tilde{\eta}_{ij}) - \hat{\gamma}_i - \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}_{(-p)}), n\lambda_k\}}{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} \tilde{w}_{ij} {Z_{ijp}}^2},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is the same soft-thresholding operator defined above.</p>
<p>MM algorithm can also be applied for solving this problem since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>η</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>η</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>&lt;</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum\limits_{k = 1}^{k_{ij}} \frac{e^{\hat{\alpha}_{k} + \eta_{ij}}}{(1 + e^{\hat{\alpha}_{k} + \eta_{ij}})^2} &lt; \frac{1}{4} k_{ij}</annotation></semantics></math>.
The majorizing surrogate function is constructed based on
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐖</mi><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mn>4</mn></mfrac><msub><mi>k</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mn>4</mn></mfrac><msub><mi>k</mi><mrow><mi>m</mi><mo>,</mo><msub><mi>n</mi><mi>m</mi></msub></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{W} = \begin{pmatrix} \frac{1}{4}k_{11} &amp;  &amp;  \\  &amp; \ddots &amp;  \\ &amp;  &amp; \frac{1}{4}k_{m,n_m} \end{pmatrix}_{n \times n},</annotation></semantics></math>
and the corresponding updating function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>S</mi><mo stretchy="false" form="prefix">{</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>η</mi><mo accent="true">̃</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>𝐙</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mover><mi>𝛃</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mn>4</mn><mi>n</mi><msub><mi>λ</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><msub><mi>k</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mn>2</mn></msup></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\beta_p = \frac{S\{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} k_{ij} {Z_{ijp}} (Z(\tilde{\eta}_{ij}) - \hat{\gamma}_i - \boldsymbol{Z}_{ij} \tilde{\boldsymbol{\beta}}_{(-p)}), 4n\lambda_k\}}{\sum\limits_{i = 1}^m \sum\limits_{j = 1}^{n_i} k_{ij} {Z_{ijp}}^2}.</annotation></semantics></math></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
