<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>grplasso • grplasso</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="grplasso">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grplasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/grplasso.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix">
<li><a class="dropdown-item" href="../articles/Models.html">Models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/grplasso/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>grplasso</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/grplasso/blob/HEAD/vignettes/grplasso.Rmd" class="external-link"><code>vignettes/grplasso.Rmd</code></a></small>
      <div class="d-none name"><code>grplasso.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction:<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>grplasso</code> is a specialized R package designed for fitting
penalized regression models in settings involving high-dimensional
grouped (or clustered) effects. Unlike traditional lasso approaches that
treat all covariates equally, grplasso distinguishes and efficiently
handles group structures to improve the computational performance.</p>
<p>This tutorial demonstrates how to apply <code>grplasso</code> in
practice using illustrative example datasets.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation:<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"UM-KevinHe/grplasso"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start:<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>In this section, we will explore the fundamental usage of the
functions integrated into the current R package, providing a detailed
interpretation of the resulting values obtained from these functions. To
enhance users’ understanding of the R package, we will employ example
datasets, enabling a comprehensive grasp of its functionalities.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UM-KevinHe/grplasso" class="external-link">grplasso</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre></div>
<div class="section level3">
<h3 id="generalized-linear-models-glms">1. Generalized Linear Models (GLMs)<a class="anchor" aria-label="anchor" href="#generalized-linear-models-glms"></a>
</h3>
<p>To exemplify the process of fitting a generalized linear model, we
will utilize the “BinaryData” dataset included in the package. This
dataset consists of five predictors, an indicator for provider
information, and a binary outcome variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BinaryData</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">BinaryData</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">Y.char</span> <span class="op">&lt;-</span> <span class="va">BinaryData</span><span class="op">$</span><span class="va">Y.char</span> <span class="co"># variable name of outcome variable</span></span>
<span><span class="va">prov.char</span> <span class="op">&lt;-</span> <span class="va">BinaryData</span><span class="op">$</span><span class="va">prov.char</span> <span class="co"># variable name of provider indicator</span></span>
<span><span class="va">Z.char</span> <span class="op">&lt;-</span> <span class="va">BinaryData</span><span class="op">$</span><span class="va">Z.char</span> <span class="co"># variable names of predictors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Y Prov.ID     Z1     Z2     Z3     Z4     Z5</span></span>
<span><span class="co">#&gt; 1 1      10 -0.006 -0.159  0.588  0.378 -1.430</span></span>
<span><span class="co">#&gt; 2 0      11  0.862 -0.162  0.243  0.503  0.549</span></span>
<span><span class="co">#&gt; 3 0      11  0.453  0.961  0.665  0.522  0.859</span></span>
<span><span class="co">#&gt; 4 1       8 -0.286  0.001  0.903  0.886 -0.324</span></span>
<span><span class="co">#&gt; 5 0      13  0.564 -0.194 -0.062 -0.792 -0.783</span></span>
<span><span class="co">#&gt; 6 1      18  0.676  1.095  2.223  1.367  1.060</span></span></code></pre></div>
<div class="section level4">
<h4 id="without-grouped-covariate">Without grouped covariate<a class="anchor" aria-label="anchor" href="#without-grouped-covariate"></a>
</h4>
<p>The <code><a href="../reference/pp.lasso.html">pp.lasso()</a></code> function is employed to fit a generalized
linear model when the covariate does not include any group information.
When the user does not specify the regularization coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
our function automatically generates a sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values by default. The sequence starts with the largest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
which penalizes all covariates to zero, and then gradually decreases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
to allow for variable selection and modeling flexibility.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pp.lasso.html">pp.lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Y.char</span>, <span class="va">Z.char</span>, <span class="va">prov.char</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> function serves to provide estimates of the
coefficients in the fitted model. The resulting coefficient matrix is
structured such that the column names correspond to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values used in the modeling process.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    0.132    0.1202    0.1096    0.0998     0.091</span></span>
<span><span class="co">#&gt; Z1     0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z2     0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z3     0 0.1120347 0.2148847 0.3098777 0.3980465</span></span>
<span><span class="co">#&gt; Z4     0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z5     0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;        0.132     0.1202     0.1096     0.0998      0.091</span></span>
<span><span class="co">#&gt; 1 -0.2411977 -0.2939898 -0.3431091 -0.3889330 -0.4318211</span></span>
<span><span class="co">#&gt; 2 -1.9635362 -1.8742433 -1.7984115 -1.7336457 -1.6779754</span></span>
<span><span class="co">#&gt; 3 -1.2089403 -1.1883078 -1.1712888 -1.1572109 -1.1455229</span></span>
<span><span class="co">#&gt; 4 -1.9600386 -1.8922127 -1.8332183 -1.7815619 -1.7360041</span></span>
<span><span class="co">#&gt; 5 -0.5500569 -0.5698456 -0.5894538 -0.6087582 -0.6276779</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function is designed to generate a figure
depicting the regularization path. This path illustrates the behavior of
the coefficients for each predictor variable as the regularization
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
varies. By visualizing the regularization path, users can gain valuable
insights into the impact of different regularization strengths on the
coefficients, aiding in model interpretation and selection.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-7-1.png" alt="Coefficient selection path for the generalized linear model without grouped covariates" width="700"></p>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function is utilized to generate model
predictions for a given dataset based on the coefficient estimates
obtained from the fitted model. Once the model has been trained using
the <code><a href="../reference/pp.lasso.html">pp.lasso()</a></code> function and the coefficients have been
estimated, the predict function can be applied to new data to obtain
predictions for the outcome variable.</p>
<p>This function offers various types of outputs to suit different
analysis needs. For instance, when fitting a penalized logistic
regression model, using <strong>type = “response”</strong> provides the
probabilities of “Y = 1” for each observation, while <strong>type =
“class”</strong> provides the predicted class.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">Z.char</span>, <span class="va">prov.char</span>, lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;          0.132    0.1202    0.1096    0.0998     0.091</span></span>
<span><span class="co">#&gt; [1,] 0.2874999 0.2996927 0.3106971 0.3206762 0.3297643</span></span>
<span><span class="co">#&gt; [2,] 0.2051302 0.2112109 0.2163924 0.2208163 0.2246015</span></span>
<span><span class="co">#&gt; [3,] 0.2051302 0.2191951 0.2321638 0.2441339 0.2551989</span></span>
<span><span class="co">#&gt; [4,] 0.3947391 0.4208778 0.4449423 0.4671087 0.4875485</span></span>
<span><span class="co">#&gt; [5,] 0.2345694 0.2340619 0.2330311 0.2316163 0.2299295</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">Z.char</span>, <span class="va">prov.char</span>, lambda <span class="op">=</span> <span class="fl">0.001</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 0 0 1 0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="with-grouped-covariate">With grouped covariate<a class="anchor" aria-label="anchor" href="#with-grouped-covariate"></a>
</h4>
<p>The utilization of the <code><a href="../reference/grp.lasso.html">grp.lasso()</a></code> function is similar
to the previously mentioned methods, with the added requirement of
providing group information for the covariates. When calling the
function, users should provide the necessary group information to ensure
proper grouping of variables for regularization. However, if the user
does not explicitly provide the group information, the
<code><a href="../reference/grp.lasso.html">grp.lasso()</a></code> function will automatically assume that each
variable is treated as an individual group on its own. This default
behavior simplifies the process for users who do not wish to specify
explicit groups, ensuring that the function can still be applied
effectively without the need for additional input.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">BinaryData</span><span class="op">$</span><span class="va">group</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grp.lasso.html">grp.lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Y.char</span>, <span class="va">Z.char</span>, <span class="va">prov.char</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit2</span>, label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-9-1.png" alt="Coefficient selection path for the generalized linear model with grouped covariates" width="700"></p>
<p>Please note that for both <code><a href="../reference/pp.lasso.html">pp.lasso()</a></code> and
<code><a href="../reference/grp.lasso.html">grp.lasso()</a></code> functions, the parameter “prov.char” is
optional. In the event that the user does not specify the provider
information for the observations, the program will automatically assume
that all observations originate from the same health provider, resulting
in the generation of one common intercept.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.no_prov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pp.lasso.html">pp.lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Y.char</span>, <span class="va">Z.char</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Provider information not provided. All data is assumed to originate</span></span>
<span><span class="co">#&gt; from a single provider!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.no_prov</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    0.2513    0.2289    0.2086    0.1901    0.1732</span></span>
<span><span class="co">#&gt; Z1      0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z2      0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z3      0 0.1006904 0.1935559 0.2800125 0.3610722</span></span>
<span><span class="co">#&gt; Z4      0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; Z5      0 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.no_prov</span><span class="op">)</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co">#"gamma" is treated as the common intercept</span></span>
<span><span class="co">#&gt;     0.2513     0.2289     0.2086     0.1901     0.1732 </span></span>
<span><span class="co">#&gt; -0.5838804 -0.5896897 -0.5974013 -0.6065479 -0.6167685</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="regularization-parameter-selection-for-glm-problems">Regularization parameter selection for GLM problems<a class="anchor" aria-label="anchor" href="#regularization-parameter-selection-for-glm-problems"></a>
</h4>
<p>The optimal regularization parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>)
is determined through cross-validation. To find the best
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
users can employ either the <code><a href="../reference/cv.pp.lasso.html">cv.pp.lasso()</a></code> or
<code><a href="../reference/cv.grp.lasso.html">cv.grp.lasso()</a></code> function, depending on the specific type of
model they are working with. These cross-validation functions inherit
the parameters required for the model fitting process, providing a
seamless and straightforward experience for users. By default, both
functions utilize 10-fold cross-validation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.pp.lasso.html">cv.pp.lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Y.char</span>, <span class="va">Z.char</span>, <span class="va">prov.char</span>, nfolds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, applied to a
<code>cv.pp.lasso</code> or <code>cv.grp.lasso</code> object, generates
a figure that enables users to assess how the cross-entropy loss changes
with varying values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
By observing the plot, users can easily identify the point at which the
cross-entropy loss is minimized.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-12-1.png" alt="Regularization parameter selection for GLM problems" width="700"></p>
<p>Indeed, users can directly use the <em>fit$lambda.min</em> command to
obtain the optimal value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="co">#&gt; [1] 0.001259591</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="discrete-survival-models">2. Discrete Survival Models<a class="anchor" aria-label="anchor" href="#discrete-survival-models"></a>
</h3>
<p>The <code><a href="../reference/pp.DiscSurv.html">pp.DiscSurv()</a></code> function is utilized for fitting a
penalized discrete survival model. In contrast to the current R package,
this function does not necessitate data expansion based on discrete time
points, resulting in a significant reduction in memory usage and
convergence time required for operation.</p>
<p>The <code>DiscTime</code> dataset, included in this package,
comprises of 5 covariates, provider information, observation time, and
event indicator. We will be using this dataset as an example to
illustrate how to utilize it.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DiscTime</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">DiscTime</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">Event.char</span> <span class="op">&lt;-</span> <span class="va">DiscTime</span><span class="op">$</span><span class="va">Event.char</span></span>
<span><span class="va">Time.char</span> <span class="op">&lt;-</span> <span class="va">DiscTime</span><span class="op">$</span><span class="va">Time.char</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Prov.ID     Z1     Z2     Z3     Z4     Z5  time status</span></span>
<span><span class="co">#&gt; 1       4 -1.298 -1.471 -1.346 -1.775 -1.241  1.03      1</span></span>
<span><span class="co">#&gt; 2       5  0.192  0.163  0.953  1.083  0.371 12.50      0</span></span>
<span><span class="co">#&gt; 3       4 -2.315 -2.038 -1.629 -2.577 -2.008  0.53      1</span></span>
<span><span class="co">#&gt; 4       1 -0.198  1.231  0.633  0.739  0.214  6.74      1</span></span>
<span><span class="co">#&gt; 5       2  0.469  0.640 -0.583  0.161  0.927 12.50      0</span></span>
<span><span class="co">#&gt; 6       4 -1.445 -1.848 -3.024 -2.117 -1.894  0.53      1</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pp.DiscSurv.html">pp.DiscSurv</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">prov.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/pp.DiscSurv.html">pp.DiscSurv()</a></code> function yields three main sets of
coefficients as its primary output. These coefficients pertain to the
covariate estimates, log-transformed baseline hazard for various time
points, and provider effects. To avoid multicollinearity problems, we
designate the first provider as the reference group.</p>
<p>Similar to the GLM fitting functions mentioned earlier,
<code><a href="../reference/pp.DiscSurv.html">pp.DiscSurv()</a></code> is also furnished with a <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>
function. This function facilitates the provision of coefficient
estimates within the fitted penalized discrete survival model across the
entire sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values employed in the modeling procedure.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    0.1601     0.1458     0.1329     0.1211     0.1103</span></span>
<span><span class="co">#&gt; Z1      0 -0.1735757 -0.3325774 -0.4793679 -0.6155647</span></span>
<span><span class="co">#&gt; Z2      0  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; Z3      0  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; Z4      0  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; Z5      0  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;       0.1601     0.1458    0.1329     0.1211     0.1103</span></span>
<span><span class="co">#&gt; 1  0.0000000  0.0000000  0.000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; 2 -4.5665147 -4.3516946 -4.162992 -3.9945779 -3.8425705</span></span>
<span><span class="co">#&gt; 3 -0.7478311 -0.7116142 -0.682481 -0.6580980 -0.6367834</span></span>
<span><span class="co">#&gt; 4  1.2412090  1.1456446  1.059286  0.9815198  0.9121089</span></span>
<span><span class="co">#&gt; 5 -2.3399410 -2.1966372 -2.070536 -1.9577270 -1.8555876</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;                 0.1601    0.1458    0.1329    0.1211    0.1103</span></span>
<span><span class="co">#&gt; [Time: 0.53] -1.668065 -1.747753 -1.824209 -1.898663 -1.971909</span></span>
<span><span class="co">#&gt; [Time: 1.03] -1.480994 -1.526815 -1.571328 -1.615488 -1.659886</span></span>
<span><span class="co">#&gt; [Time: 3.92] -1.622145 -1.641556 -1.661848 -1.683563 -1.706991</span></span>
<span><span class="co">#&gt; [Time: 6.74] -1.251585 -1.257340 -1.264124 -1.272503 -1.282795</span></span>
<span><span class="co">#&gt; [Time: 12.5] -1.781635 -1.780095 -1.780526 -1.783340 -1.788771</span></span></code></pre></div>
<p>Users have the option to utilize the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function,
which generates a figure illustrating the regularization path. This
visual representation showcases the behavior of the coefficients for
each predictor variable as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
varies.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-17-1.png" alt="Coefficient selection path for the discrete survival model" width="700"></p>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function is employed to generate model
predictions for a given dataset using the coefficient estimates obtained
from the fitted model. It is essential to note that the discrete time
points within the prediction data set must align with the discrete time
points used during model fitting. If they do not match, the baseline
hazard of mismatches cannot be estimated accurately.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">prov.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span>, type <span class="op">=</span> <span class="st">"response"</span>, which.lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;   Individual [Time: 0.53] [Time: 1.03] [Time: 3.92] [Time: 6.74] [Time: 12.5]</span></span>
<span><span class="co">#&gt; 1          1    0.1586823    0.1852773           NA           NA           NA</span></span>
<span><span class="co">#&gt; 2          2    0.1586823    0.1852773    0.1649092    0.2224258    0.1441013</span></span>
<span><span class="co">#&gt; 3          3    0.1586823           NA           NA           NA           NA</span></span>
<span><span class="co">#&gt; 4          4    0.1586823    0.1852773    0.1649092    0.2224258           NA</span></span>
<span><span class="co">#&gt; 5          5    0.1586823    0.1852773    0.1649092    0.2224258    0.1441013</span></span></code></pre></div>
<div class="section level4">
<h4 id="regularization-parameter-selection-for-discrete-survival-models">Regularization parameter selection for discrete survival models<a class="anchor" aria-label="anchor" href="#regularization-parameter-selection-for-discrete-survival-models"></a>
</h4>
<p>The optimal regularization parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>)
is determined through cross-validation, utilizing the cross-validation
error as the guiding metric. Users can identify the best
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
value by employing the <code><a href="../reference/cv.pp.DiscSurv.html">cv.pp.DiscSurv()</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.pp.DiscSurv.html">cv.pp.DiscSurv</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">prov.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, nfolds <span class="op">=</span> <span class="fl">10</span>, trace.cv <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting CV fold #1...</span></span>
<span><span class="co">#&gt; Starting CV fold #2...</span></span>
<span><span class="co">#&gt; Starting CV fold #3...</span></span>
<span><span class="co">#&gt; Starting CV fold #4...</span></span>
<span><span class="co">#&gt; Starting CV fold #5...</span></span>
<span><span class="co">#&gt; Starting CV fold #6...</span></span>
<span><span class="co">#&gt; Starting CV fold #7...</span></span>
<span><span class="co">#&gt; Starting CV fold #8...</span></span>
<span><span class="co">#&gt; Starting CV fold #9...</span></span>
<span><span class="co">#&gt; Starting CV fold #10...</span></span></code></pre></div>
<p>Users can either utilize the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function or directly
access the <em>fit$lambda.min</em> command to identify the optimal value
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
at which the cross-entropy loss is minimized.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-20-1.png" alt="Regularization parameter selection for discrete survival models" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="co">#&gt; [1] 0.00243264</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="discrete-survival-model-with-no-grouped-or-clusted-information-provided">Discrete survival model with no grouped (or clusted) information
provided<a class="anchor" aria-label="anchor" href="#discrete-survival-model-with-no-grouped-or-clusted-information-provided"></a>
</h4>
<p>Similar with our GLM-related functions, we present a solution for
fitting a discrete survival model without requiring provider
information. This approach tackles the issue commonly encountered with
existing statistical tools used to fit discrete survival models, which
often necessitate data expansion, leading to significantly slow
convergence.</p>
<p>For ease of use, we have introduced a new function called
<code><a href="../reference/DiscSurv.html">DiscSurv()</a></code>, designed to facilitate a similar user
experience to <code><a href="../reference/pp.DiscSurv.html">pp.DiscSurv()</a></code>. However, the key difference
lies in the fact that <code><a href="../reference/DiscSurv.html">DiscSurv()</a></code> no longer demands provider
information from the user, meaning that all observations are now treated
as originating from the same healthcare provider.</p>
<p>Additionally, we have provided the <code><a href="../reference/cv.DiscSurv.html">cv.DiscSurv()</a></code>
function to aid users in selecting optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
Moreover, the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>, and
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> functions have also been thoughtfully
incorporated.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DiscSurv.html">DiscSurv</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span><span class="op">)</span> <span class="co"># no provider information required</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co">#time effect</span></span>
<span><span class="co">#&gt;                 0.4261    0.3882    0.3537    0.3223    0.2937    0.2676</span></span>
<span><span class="co">#&gt; [Time: 0.53] -1.979501 -1.970055 -1.977003 -1.996580 -2.025956 -2.063289</span></span>
<span><span class="co">#&gt; [Time: 1.03] -2.110213 -2.069229 -2.043936 -2.030857 -2.027098 -2.024884</span></span>
<span><span class="co">#&gt; [Time: 3.92] -2.484907 -2.418504 -2.367851 -2.329504 -2.300539 -2.271883</span></span>
<span><span class="co">#&gt; [Time: 6.74] -2.355695 -2.272311 -2.204520 -2.148985 -2.102832 -2.057118</span></span>
<span><span class="co">#&gt; [Time: 12.5] -2.958691 -2.863140 -2.784495 -2.719193 -2.664086 -2.607955</span></span>
<span><span class="co">#&gt;                 0.2438    0.2221    0.2024    0.1844</span></span>
<span><span class="co">#&gt; [Time: 0.53] -2.108335 -2.159552 -2.215497 -2.275267</span></span>
<span><span class="co">#&gt; [Time: 1.03] -2.029997 -2.041139 -2.057146 -2.077164</span></span>
<span><span class="co">#&gt; [Time: 3.92] -2.250817 -2.236107 -2.226728 -2.221906</span></span>
<span><span class="co">#&gt; [Time: 6.74] -2.019042 -1.987381 -1.961174 -1.939721</span></span>
<span><span class="co">#&gt; [Time: 12.5] -2.560084 -2.519189 -2.484282 -2.454649</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co">#covariate coefficient</span></span>
<span><span class="co">#&gt;    0.4261     0.3882     0.3537     0.3223       0.2937      0.2676     0.2438</span></span>
<span><span class="co">#&gt; Z1      0 -0.1556065 -0.2988513 -0.4321738 -0.555131105 -0.62728969 -0.6971121</span></span>
<span><span class="co">#&gt; Z2      0  0.0000000  0.0000000  0.0000000  0.000000000  0.00000000  0.0000000</span></span>
<span><span class="co">#&gt; Z3      0  0.0000000  0.0000000  0.0000000  0.000000000  0.00000000  0.0000000</span></span>
<span><span class="co">#&gt; Z4      0  0.0000000  0.0000000  0.0000000  0.000000000  0.00000000  0.0000000</span></span>
<span><span class="co">#&gt; Z5      0  0.0000000  0.0000000  0.0000000 -0.003068977 -0.06697318 -0.1271421</span></span>
<span><span class="co">#&gt;        0.2221     0.2024       0.1844</span></span>
<span><span class="co">#&gt; Z1 -0.7648862 -0.8306053 -0.891723581</span></span>
<span><span class="co">#&gt; Z2  0.0000000  0.0000000  0.000000000</span></span>
<span><span class="co">#&gt; Z3  0.0000000  0.0000000 -0.005878473</span></span>
<span><span class="co">#&gt; Z4  0.0000000  0.0000000  0.000000000</span></span>
<span><span class="co">#&gt; Z5 -0.1840291 -0.2383354 -0.287531205</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-22-1.png" alt="Coefficient selection path for the discrete survival model with no center information provided" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.DiscSurv.html">cv.DiscSurv</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, nfolds <span class="op">=</span> <span class="fl">10</span>, trace.cv <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting CV fold #1...</span></span>
<span><span class="co">#&gt; Starting CV fold #2...</span></span>
<span><span class="co">#&gt; Starting CV fold #3...</span></span>
<span><span class="co">#&gt; Starting CV fold #4...</span></span>
<span><span class="co">#&gt; Starting CV fold #5...</span></span>
<span><span class="co">#&gt; Starting CV fold #6...</span></span>
<span><span class="co">#&gt; Starting CV fold #7...</span></span>
<span><span class="co">#&gt; Starting CV fold #8...</span></span>
<span><span class="co">#&gt; Starting CV fold #9...</span></span>
<span><span class="co">#&gt; Starting CV fold #10...</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-24-1.png" alt="Regularization parameter selection for discrete survival models with no center information provided" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, lambda <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">lambda</span>, type <span class="op">=</span> <span class="st">"response"</span>, which.lambda <span class="op">=</span> <span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;   Individual [Time: 0.53] [Time: 1.03] [Time: 3.92] [Time: 6.74] [Time: 12.5]</span></span>
<span><span class="co">#&gt; 1          1  0.491864462   0.74764296           NA           NA           NA</span></span>
<span><span class="co">#&gt; 2          2  0.009860994   0.02957994  0.041247655   0.07816691   0.05422556</span></span>
<span><span class="co">#&gt; 3          3  0.952556420           NA           NA           NA           NA</span></span>
<span><span class="co">#&gt; 4          4  0.020209741   0.05938188  0.081813820   0.14938494           NA</span></span>
<span><span class="co">#&gt; 5          5  0.001765611   0.00538432  0.007582723   0.01483601   0.01007986</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="stratified-cox-models">3. Stratified Cox Models<a class="anchor" aria-label="anchor" href="#stratified-cox-models"></a>
</h3>
<p>Our R package offers the <code><a href="../reference/Strat.cox.html">Strat.cox()</a></code> and
<code><a href="../reference/cv.strat_cox.html">cv.strat_cox()</a></code> functions designed for fitting penalized
stratified Cox models. In the context of our intended scenario, each
healthcare provider is considered a distinct stratum. The functionality
of both <code><a href="../reference/Strat.cox.html">Strat.cox()</a></code> and <code><a href="../reference/cv.strat_cox.html">cv.strat_cox()</a></code> extends
to the incorporation of group information among variables, achieved by
configuring the “group” parameter.</p>
<p>We employ the <code>ContTime</code> simulation dataset, which is
included within this package, to illustrate the utilization of these two
functions. This dataset encompasses five covariates, a provider
indicator (which serves as stratum information), as well as follow-up
time and event indicators.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ContTime</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">ContTime</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Prov.ID       Z1       Z2       Z3       Z4       Z5 status      time</span></span>
<span><span class="co">#&gt; [1,]      11 3.431888 4.397010 3.800101 4.809899 4.049038      1 0.4984520</span></span>
<span><span class="co">#&gt; [2,]       4 2.789097 2.616714 3.401736 3.510431 3.650074      0 3.0000000</span></span>
<span><span class="co">#&gt; [3,]       9 5.451523 4.009896 5.473275 4.772835 4.708293      1 0.5987062</span></span>
<span><span class="co">#&gt; [4,]      15 2.421634 2.284766 1.747758 2.182607 1.072065      1 0.6406964</span></span>
<span><span class="co">#&gt; [5,]       9 5.827436 5.238138 5.536604 5.265083 4.735679      0 3.0000000</span></span>
<span><span class="co">#&gt; [6,]      18 2.140707 1.773304 1.792366 1.774502 3.209669      0 3.0000000</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Strat.cox.html">Strat.cox</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, <span class="va">prov.char</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Users can utilize the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> function to obtain
coefficient estimates for the covariates across the complete sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    0.0394      0.0368     0.0343       0.032      0.0298</span></span>
<span><span class="co">#&gt; Z1      0 -0.01983922 -0.0390155 -0.05686517 -0.07358008</span></span>
<span><span class="co">#&gt; Z2      0  0.00000000  0.0000000  0.00000000  0.00000000</span></span>
<span><span class="co">#&gt; Z3      0  0.00000000  0.0000000  0.00000000  0.00000000</span></span>
<span><span class="co">#&gt; Z4      0  0.00000000  0.0000000  0.00000000  0.00000000</span></span>
<span><span class="co">#&gt; Z5      0  0.00000000  0.0000000  0.00000000  0.00000000</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function facilitates users in visualizing the
regularization path.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-29-1.png" alt="Coefficient selection path for the stratified Cox model with grouped covariates" width="700"></p>
<p>It’s important to highlight that the <code>prov.char</code> parameter
here is also discretionary. In the absence of user input, the program
will automatically assign all observations to a single stratum by
default. Consequently, the conventional Cox model will be employed for
fitting.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.no_stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Strat.cox.html">Strat.cox</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Provider information not provided. All data is assumed to originate</span></span>
<span><span class="co">#&gt; from a single provider!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.no_stratum</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    0.1745    0.1627      0.1517     0.1415        0.132</span></span>
<span><span class="co">#&gt; Z1      0 0.0000000 0.000000000 0.00000000 0.0000000000</span></span>
<span><span class="co">#&gt; Z2      0 0.0000000 0.000000000 0.00000000 0.0005808148</span></span>
<span><span class="co">#&gt; Z3      0 0.0155369 0.025755673 0.03313948 0.0398429622</span></span>
<span><span class="co">#&gt; Z4      0 0.0000000 0.004892787 0.01173321 0.0177767495</span></span>
<span><span class="co">#&gt; Z5      0 0.0000000 0.000000000 0.00000000 0.0000000000</span></span></code></pre></div>
<p>Likewise, the <code><a href="../reference/cv.strat_cox.html">cv.strat_cox()</a></code> function can be employed
for cross-validation, and the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function can be
utilized to visualize cross-validation error.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.strat_cox.html">cv.strat_cox</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Event.char</span>, <span class="va">Z.char</span>, <span class="va">Time.char</span>, <span class="va">prov.char</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, nfolds <span class="op">=</span> <span class="fl">10</span>, se <span class="op">=</span> <span class="st">"quick"</span><span class="op">)</span></span>
<span><span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="co">#&gt; [1] 0.004228925</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="grplasso_files/figure-html/unnamed-chunk-32-1.png" alt="Regularization parameter selection for stratified Cox models" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
